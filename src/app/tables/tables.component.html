@if (errorMessage) {
<div class="alert alert-danger text-center my-3">
  {{ errorMessage }}
</div>
}

<!-- <div class="pills p-3" appShowLoaderUntilPageLoaded [isReady]="loading">
 Search Bar 
  <div class="input-group w-100 mx-auto my-3">
    <input [(ngModel)]="searchText" (input)="filterTables()" placeholder="ابحث برقم الطاولة"
      class="form-control rounded-start" aria-describedby="search-icon" />
    <span class="input-group-text">
      <i class="fa-solid fa-magnifying-glass"></i>
    </span>
  </div>
-->
  <!-- Tabs Navigation 
  <ul class="nav nav-pills mb-4 px-0" id="pills-tab25" role="tablist">-->
    <!-- ALL -->
<!--     <li class="nav-item" role="presentation">
    <button class="nav-link active" id="pills-home-tab" data-bs-toggle="pill" data-bs-target="#pills-home" type="button" role="tab" aria-controls="pills-home" aria-selected="true">الكل
      <span>({{tabless.length}})</span>
    </button>
  </li> 
    <li class="nav-item" role="presentation">
    <button
      class="nav-link"
      [class.active]="selectedStatus === -1"
      (click)="selectStatusGroup(-1)"
      type="button"
      role="tab"
    >
      الكل <span>({{ tabless.length }})</span>
    </button>
  </li>
    <li class="nav-item" role="presentation" *ngFor="let statusGroup of filteredTablesByStatus; let i = index">
      <button class="nav-link sub"  (click)="selectStatusGroup(i)"
        [id]="'pills-' + statusGroup.status + '-tab'" data-bs-toggle="pill"
        [attr.data-bs-target]="'#pills-' + statusGroup.status" type="button" role="tab"
        [attr.aria-controls]="'pills-' + statusGroup.status" [attr.aria-selected]="selectedStatus === i">
        <span>{{ getStatusText(statusGroup.status) }}</span>
        <span>({{ statusGroup.tables.length }})</span>
      </button>
    </li>
  </ul>-->
<!--  <div class="tab-content second-sub" id="pills-tabContent5">
     <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab" tabindex="0">
        <div class="row m-0 g-3 d-flex flex-wrap">
        <div class="col-6 col-sm-6 col-lg-4 col-xl-3" *ngFor="let table of tabless">
          <div class="card p-2 pb-3" (click)="onTableClick(table.id)" [class.disabled]="table.status === 2">
            <div class="floor_number">
              <div><span class=" fw-medium"> {{table.floors?.name}} - {{table.floor_partitions
                  ?.name}} </span></div>
              <div><span class="fw-medium" [ngClass]="table.smoking == 1 ? 'text-success' : 'text-danger'">
                  {{ table?.smoking == 1 ? 'مسموح بالتدخين' : 'غير مسموح بالتدخين' }}
                </span>
              </div>

            </div>
            <div class=" d-flex flex-column flex-sm-row justify-content-between align-items-center"
              style="cursor: pointer">
              <div class="d-flex flex-nowrap align-items-center">
                <div
                  class=" d-inline-flex align-items-center btn-static bg-success text-white fw-bold text-center mx-2 mt-2 px-2">
                  <img src="../assets/images/table.png" alt="Table Icon" class="me-1" style="max-width: 20px;" />

                  <span class="fs-6 "> طاولة </span>
                  {{ table.table_number }}
                </div>


              </div>
              <span class="btn-static nav-pills fw-bold ms-2 py-1 text-center mt-2 px-3" [ngClass]="{
              'btn-static-success': table.status === 1,
              'btn-static-warning': table.status === 2
            }" [class.fs-6]="true" [class.fs-md-5]="true" [class.fs-lg-4]="true">
                {{ getStatusText(table.status) }}
              </span>
            </div>
          </div>
        </div>
      </div>
     </div>
    <div *ngFor="let statusGroup of filteredTablesByStatus; let i = index" class="tab-pane fade"
      [ngClass]="{ 'show active': selectedStatus === (i+1) }" [id]="'pills-' + statusGroup.status" role="tabpanel"
      [attr.aria-labelledby]="'pills-' + statusGroup.status + '-tab'">
      <div class="row m-0 g-3 d-flex flex-wrap">
        <div class="col-6 col-sm-6 col-lg-4 col-xl-3" *ngFor="let table of statusGroup.tables">
          <div class="card p-2 pb-3" (click)="onTableClick(table.id)" [class.disabled]="table.status === 2">
            <div class="floor_number">
              <div><span class=" fw-medium"> {{table.floors?.name}} - {{table.floor_partitions
                  ?.name}} </span></div>
              <div><span class="fw-medium" [ngClass]="table.smoking == 1 ? 'text-success' : 'text-danger'">
                  {{ table?.smoking == 1 ? 'مسموح بالتدخين' : 'غير مسموح بالتدخين' }}
                </span>
              </div>

            </div>
            <div class=" d-flex flex-column flex-sm-row justify-content-between align-items-center"
              style="cursor: pointer">
              <div class="d-flex flex-nowrap align-items-center">
                <div
                  class=" d-inline-flex align-items-center btn-static bg-success text-white fw-bold text-center mx-2 mt-2 px-2">
                  <img src="../assets/images/table.png" alt="Table Icon" class="me-1" style="max-width: 20px;" />

                  <span class="fs-6 "> طاولة </span>
                  {{ table.table_number }}
                </div>


              </div>
              <span class="btn-static nav-pills fw-bold ms-2 py-1 text-center mt-2 px-3" [ngClass]="{
              'btn-static-success': table.status === 1,
              'btn-static-warning': table.status === 2
            }" [class.fs-6]="true" [class.fs-md-5]="true" [class.fs-lg-4]="true">
                {{ getStatusText(table.status) }}
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>


    <p *ngIf="filteredTablesByStatus.length === 0" class="text-center text-muted mt-3">
      لا توجد طاولات مطابقة للبحث.
    </p>
  </div>

</div> -->
<section class="pills p-3" appShowLoaderUntilPageLoaded [isReady]="loading">
    <div class="input-group w-100 mx-auto my-3">
    <input [(ngModel)]="searchText" (input)="filterTables()" placeholder="ابحث برقم الطاولة"
      class="form-control rounded-start" aria-describedby="search-icon" />
    <span class="input-group-text">
      <i class="fa-solid fa-magnifying-glass"></i>
    </span>
  </div>
<ul class="nav nav-pills mb-4 px-0" role="tablist">
  <!-- ALL Tab -->
  <li class="nav-item" role="presentation">
    <button
      class="nav-link"
      [class.active]="selectedStatus === -1"
      (click)="selectStatusGroup(-1)"
      type="button"
      role="tab"
    >
      الكل <span>({{ tabless.length }})</span>
    </button>
  </li>

  <!-- Dynamic Tabs -->
  <li
    class="nav-item"
    role="presentation"
    *ngFor="let statusGroup of filteredTablesByStatus; let i = index"
  >
    <button
      class="nav-link sub"
      [class.active]="selectedStatus === i"
      (click)="selectStatusGroup(i)"
      type="button"
      role="tab"
    >
      <span>{{ getStatusText(statusGroup.status) }}</span>
      <span>({{ statusGroup.tables.length }})</span>
    </button>
  </li>
</ul>

<div class="tab-content second-sub">
  <!-- Reusable Tables Template -->
  <ng-container *ngTemplateOutlet="tablesList; context: { tables: activeTables }"></ng-container>

  <p *ngIf="activeTables.length === 0" class="text-center text-muted mt-3">
    لا توجد طاولات مطابقة للبحث.
  </p>
</div>

<!-- Template for tables list -->
<ng-template #tablesList let-tables="tables">
  <div class="row m-0 g-3 d-flex flex-wrap">
    <div
      class="col-6 col-sm-6 col-lg-4 col-xl-3"
      *ngFor="let table of tables; trackBy: trackByTableId"
    >
      <div class="card p-2 pb-3" (click)="onTableClick(table.id)" [class.disabled]="table.status === 2">
        <div class="floor_number">
          <div>
            <span class="fw-medium">{{ table.floors?.name }} - {{ table.floor_partitions?.name }}</span>
          </div>
          <div>
            <span class="fw-medium" [ngClass]="table.smoking == 1 ? 'text-success' : 'text-danger'">
              {{ table.smoking == 1 ? 'مسموح بالتدخين' : 'غير مسموح بالتدخين' }}
            </span>
          </div>
        </div>

        <div class="d-flex flex-column flex-sm-row justify-content-between align-items-center" style="cursor: pointer">
          <div class="d-flex flex-nowrap align-items-center">
            <div
              class="d-inline-flex align-items-center btn-static bg-success text-white fw-bold text-center mx-2 mt-2 px-2"
            >
              <img src="../assets/images/table.png" alt="Table Icon" class="me-1" style="max-width: 20px;" />
              <span class="fs-6">طاولة</span> {{ table.table_number }}
            </div>
          </div>
          <span
            class="btn-static nav-pills fw-bold ms-2 py-1 text-center mt-2 px-3"
            [ngClass]="{
              'btn-static-success': table.status === 1,
              'btn-static-warning': table.status === 2
            }"
          >
            {{ getStatusText(table.status) }}
          </span>
        </div>
      </div>
    </div>
  </div>
</ng-template>
</section>